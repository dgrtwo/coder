<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classcodes • coder</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Classcodes">
<meta property="og:description" content="coder">
<meta property="og:image" content="eribul.github.io/coder/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/coder.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Interpret_regular_expressions.html">Interpret regular expressions</a>
    </li>
    <li>
      <a href="../articles/classcodes.html">Classcodes</a>
    </li>
    <li>
      <a href="../articles/ex_data.html">Example data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/eribul/coder/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="classcodes_files/header-attrs-2.5/header-attrs.js"></script><link href="classcodes_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="classcodes_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Classcodes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eribul/coder/blob/master/vignettes/classcodes.Rmd"><code>vignettes/classcodes.Rmd</code></a></small>
      <div class="hidden name"><code>classcodes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://eribul.github.io/coder">coder</a></span><span class="op">)</span></code></pre></div>
<div id="motivating-example" class="section level1">
<h1 class="hasAnchor">
<a href="#motivating-example" class="anchor"></a>Motivating example</h1>
<p>Let’s consider some example data (<code>ex_peopple</code> and <code>ex_icd10</code>) from <code><a href="../articles/ex_data.html">vignette("ex_data")</a></code>.</p>
<p>Let’s categorize those patients by their Charlson comorbidity:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">ex_people</span>, codedata <span class="op">=</span> <span class="va">ex_icd10</span>, cc <span class="op">=</span> <span class="va">charlson</span>, id <span class="op">=</span> <span class="st">"name"</span>, code <span class="op">=</span> <span class="st">"icd10"</span><span class="op">)</span>
<span class="co">#&gt; Classification based on: icd10</span>
<span class="co">#&gt; # A tibble: 100 x 25</span>
<span class="co">#&gt;    name  surgery    myocardial.infa… congestive.hear… peripheral.vasc…</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;date&gt;     &lt;lgl&gt;            &lt;lgl&gt;            &lt;lgl&gt;           </span>
<span class="co">#&gt;  1 Chen… 2020-09-29 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  2 Grav… 2020-06-21 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  3 Truj… 2020-06-08 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  4 Simp… 2020-09-10 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  5 Chin… 2020-08-24 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  6 Le, … 2020-03-28 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  7 Kang… 2020-06-30 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  8 Shue… 2020-03-29 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt;  9 Bouc… 2020-09-04 FALSE            FALSE            TRUE            </span>
<span class="co">#&gt; 10 Le, … 2020-08-09 FALSE            FALSE            FALSE           </span>
<span class="co">#&gt; # … with 90 more rows, and 20 more variables: cerebrovascular.disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   dementia &lt;lgl&gt;, chronic.pulmonary.disease &lt;lgl&gt;, rheumatic.disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   peptic.ulcer.disease &lt;lgl&gt;, mild.liver.disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   diabetes.without.complication &lt;lgl&gt;, hemiplegia.or.paraplegia &lt;lgl&gt;,</span>
<span class="co">#&gt; #   renal.disease &lt;lgl&gt;, diabetes.complication &lt;lgl&gt;, malignancy &lt;lgl&gt;,</span>
<span class="co">#&gt; #   moderate.or.severe.liver.disease &lt;lgl&gt;, metastatic.solid.tumor &lt;lgl&gt;,</span>
<span class="co">#&gt; #   AIDS.HIV &lt;lgl&gt;, charlson &lt;dbl&gt;, deyo_ramano &lt;dbl&gt;, dhoore &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ghali &lt;dbl&gt;, quan_original &lt;dbl&gt;, quan_updated &lt;dbl&gt;</span></code></pre></div>
<p>Here, <code>charlson</code> (as supplied by the <code>cc</code> argument) is a “classcodes” object containing a classification scheme. This is the specification of how to match <code>ex_icd10$icd10</code> to each condition recognized by the Charlson comorbidity classification. It is based on regular expressions (see <code><a href="https://rdrr.io/r/base/regex.html">?regex</a></code>).</p>
</div>
<div id="default-classcodes" class="section level1">
<h1 class="hasAnchor">
<a href="#default-classcodes" class="anchor"></a>Default classcodes</h1>
<p>There are 7 default “classcodes” objects in the package (<code>classcodes</code> column below). Each of them might have several versions of regular expressions (column <code>regex</code>) and weighted indices (column <code>indices</code>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/all_classcodes.html">all_classcodes</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 7 x 3</span>
<span class="co">#&gt;   classcodes   regex                             indices                        </span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;                             &lt;chr&gt;                          </span>
<span class="co">#&gt; 1 charlson     icd10, icd9cm_deyo, icd9cm_enhan… "charlson, deyo_ramano, dhoore…</span>
<span class="co">#&gt; 2 cps          icd10                             "only_ordinary"                </span>
<span class="co">#&gt; 3 elixhauser   icd10, icd10_short, icd9cm, icd9… "sum_all, sum_all_ahrq, walrav…</span>
<span class="co">#&gt; 4 hip_ae       icd10, kva, icd10_fracture        ""                             </span>
<span class="co">#&gt; 5 hip_ae_hail… icd10, kva                        ""                             </span>
<span class="co">#&gt; 6 knee_ae      icd10, kva                        ""                             </span>
<span class="co">#&gt; 7 rxriskv      atc_pratt, atc_caughey, atc_garl… "pratt, sum_all"</span></code></pre></div>
</div>
<div id="classcodes-object" class="section level1">
<h1 class="hasAnchor">
<a href="#classcodes-object" class="anchor"></a>classcodes object</h1>
<p>Each of those classcodes objects are documented (see for example <code><a href="../reference/charlson.html">?charlson</a></code>). Those objects are basically tibbles (data frames) with some additional attributes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">charlson</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Classcodes object</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Regular expressions:</span>
<span class="co">#&gt;    icd10, icd9cm_deyo, icd9cm_enhanced, icd10_rcs, icd8_brusselaers, icd9_brusselaers </span>
<span class="co">#&gt; Indices:</span>
<span class="co">#&gt;    charlson, deyo_ramano, dhoore, ghali, quan_original, quan_updated   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 17 x 14</span>
<span class="co">#&gt;    group description icd10 icd9cm_deyo icd9cm_enhanced icd10_rcs</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt;    </span>
<span class="co">#&gt;  1 myoc… Acute myoc… I2([… 41[02]      41[02]          "I2([1-3…</span>
<span class="co">#&gt;  2 cong… Heart fail… I(09… 428         39891|4(0(2([0… "I(1[13]…</span>
<span class="co">#&gt;  3 peri… Peripheral… I7([… 44(39|1)|7… 0930|4(373|4[0… "(I7([0-…</span>
<span class="co">#&gt;  4 cere… Cerebrovas… G4[5… 43[0-8]     36234|43[0-8]   "G4[56]|…</span>
<span class="co">#&gt;  5 deme… Senile and… F0([… 290         29(0|41)|3312   "A810|F0…</span>
<span class="co">#&gt;  6 chro… Chronic ob… (I27… 490|50([0-… 4(16[89]|9)|50… "(I2[67]…</span>
<span class="co">#&gt;  7 rheu… Systemic l… M(0[… 7(1(0[014]… 4465|7(1(0[0-4… "M(0[569…</span>
<span class="co">#&gt;  8 pept… Gastric, d… K2[5… 53[1-4]     53[1-4]          &lt;NA&gt;    </span>
<span class="co">#&gt;  9 mild… Alcoholic … B18|… 571[24-6]   070([23]{2}|[4…  &lt;NA&gt;    </span>
<span class="co">#&gt; 10 diab… Diabetes w… E1[0… 250[0-37]   250[0-389]       &lt;NA&gt;    </span>
<span class="co">#&gt; 11 hemi… Paraplegia… G(04… 34(41|2)    3(341|4([23]|4… "G(114|8…</span>
<span class="co">#&gt; 12 rena… Chronic gl… I1(2… 58([2568]|… 40(3([019]1)|4… "I1[23]|…</span>
<span class="co">#&gt; 13 diab… Diabetes w… E1[0… 250[4-6]    250[4-7]        "E1[0-4]"</span>
<span class="co">#&gt; 14 mali… Malignant … C([0… (1([4-68]|… 1([4-68]|7[0-2… "C([01]|…</span>
<span class="co">#&gt; 15 mode… Hepatic co… I(8(… 456[01]|57… 456[0-2]|572[2… "B18|I(8…</span>
<span class="co">#&gt; 16 meta… Secondary … C(7[… 19([6-8]|9… 19[6-9]         "C(7[7-9…</span>
<span class="co">#&gt; 17 AIDS… HIV infect… B2[0… 04[2-4]     04[2-4]         "B2[0-4]"</span>
<span class="co">#&gt; # … with 8 more variables: icd8_brusselaers &lt;chr&gt;, icd9_brusselaers &lt;chr&gt;,</span>
<span class="co">#&gt; #   charlson &lt;dbl&gt;, deyo_ramano &lt;dbl&gt;, dhoore &lt;dbl&gt;, ghali &lt;dbl&gt;,</span>
<span class="co">#&gt; #   quan_original &lt;dbl&gt;, quan_updated &lt;dbl&gt;</span></code></pre></div>
<p>Columns have pre-specified names and/or content:</p>
<ul>
<li>
<code>group</code>: short descriptive names of all groups to classify by (i.e. medical conditions/comorbidities in the Charlson case)</li>
<li>
<code>description:</code> (optional) details describing each group</li>
<li>regular expressions identifying each group (see <code><a href="../articles/Interpret_regular_expressions.html">vignette("Interpret_regular_expressions")</a></code> for details and <code><a href="../reference/charlson.html">?charlson</a></code> for concrete examples). Multiple versions might be used if combined with different code sets (i.e. ICD-9 versus ICD-10) or as suggested by different sources/authors. (Column names are arbitrary but identified by <code><a href="https://rdrr.io/r/base/attr.html">attr(., "regexprs")</a></code> and specified by argument <code>regex</code> in <code><a href="../reference/classcodes.html">as.classcodes()</a></code>).</li>
<li>numeric vectors used as weights when calculating index sums based on all (or a subset of) individual groups. (Column names are arbitrary but identified by <code><a href="https://rdrr.io/r/base/attr.html">attr(., "indices")</a></code> and specified by argument <code>indices</code> in <code><a href="../reference/classcodes.html">as.classcodes()</a></code>.)</li>
<li>
<code>condition</code>: (optional) conditional classification (not used with <code>charlson</code> but see example below).</li>
</ul>
<p>In the example above, we did not specify which version of the regular expressions to use. We see from the printed output above (or by <code><a href="https://rdrr.io/r/base/attr.html">attr(charlson, "regexprs")</a></code>), that the first regular expression is “icd10.” This will be used by default. We have ICD-10 codes recorded in our code data set (<code>ex_icd10$icd10</code>). We might therefore use either “icd10” or the alternative “icd10_rcs.” Other versions might be relevant if the medical data is coded by other codes (such as earlier versions of ICD). We will show below how to alter this setting in practice.</p>
</div>
<div id="hierarchy" class="section level1">
<h1 class="hasAnchor">
<a href="#hierarchy" class="anchor"></a>Hierarchy</h1>
<p>Some classcodes objects have an additional class attribute “hierarchy,” controlling hierarchical groups where only one of possibly several groups should be used in weighted index sums. The classcodes object for the Elixhauser comorbidity classification has this property:<br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">elixhauser</span>, n <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># preview 0 rows but present the attributes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Classcodes object</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Regular expressions:</span>
<span class="co">#&gt;    icd10, icd10_short, icd9cm, icd9cm_ahrqweb, icd9cm_enhanced </span>
<span class="co">#&gt; Indices:</span>
<span class="co">#&gt;    sum_all, sum_all_ahrq, walraven, sid29, sid30, ahrq_mort, ahrq_readm </span>
<span class="co">#&gt; Hierarchy:</span>
<span class="co">#&gt;    c("metastatic cancer", "solid tumor"),</span>
<span class="co">#&gt;    c("diabetes uncomplicated", "diabetes complicated")</span></code></pre></div>
<p>This means that patients who have both metastatic cancer and solid tumors should be recognized as such if classified. If such patient are assigned an aggregated index score, however, only the largest score is used (in this case for a metastatic cancer as superior to a solid tumor). The same is true for patients diagnosed with both uncomplicated and complicated diabetes.</p>
<p>Consider a patient Alice with some diagnoses:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Alice"</span><span class="op">)</span>
<span class="va">diags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C01"</span>, <span class="st">"C801"</span>, <span class="st">"E1010"</span>, <span class="st">"E1021"</span><span class="op">)</span>
<span class="fu">decoder</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/decoder/man/decode.html">decode</a></span><span class="op">(</span><span class="va">diags</span>, <span class="fu">decoder</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/decoder/man/icd10cm.html">icd10cm</a></span><span class="op">)</span>
<span class="co">#&gt; [1] "Malignant neoplasm of base of tongue"                   </span>
<span class="co">#&gt; [2] "Malignant (primary) neoplasm, unspecified"              </span>
<span class="co">#&gt; [3] "Type 1 diabetes mellitus with ketoacidosis without coma"</span>
<span class="co">#&gt; [4] "Type 1 diabetes mellitus with diabetic nephropathy"</span></code></pre></div>
<p>According to Elixhauser, poor Alice has both a solid tumor and a metastatic cancer, as well as diabetes both with and without complications. The (unweighted) index “sum_all,” however will not equal 4 but 2, since metastatic cancer and diabetes with complications subsume solid tumors and diabetes without complications.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">icd10</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Alice"</span>, icd10 <span class="op">=</span> <span class="va">diags</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">pat</span>, codedata <span class="op">=</span> <span class="va">icd10</span>, cc <span class="op">=</span> <span class="va">elixhauser</span>, 
                id <span class="op">=</span> <span class="st">"id"</span>, code <span class="op">=</span> <span class="st">"icd10"</span>, index <span class="op">=</span> <span class="st">"sum_all"</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Classification based on: icd10</span>
<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt;                                [,1]   </span>
<span class="co">#&gt; id                             "Alice"</span>
<span class="co">#&gt; congestive heart failure       "FALSE"</span>
<span class="co">#&gt; cardiac arrhythmias            "FALSE"</span>
<span class="co">#&gt; valvular disease               "FALSE"</span>
<span class="co">#&gt; pulmonary circulation disorder "FALSE"</span>
<span class="co">#&gt; peripheral vascular disorder   "FALSE"</span>
<span class="co">#&gt; hypertension uncomplicated     "FALSE"</span>
<span class="co">#&gt; hypertension complicated       "FALSE"</span>
<span class="co">#&gt; paralysis                      "FALSE"</span>
<span class="co">#&gt; other neurological disorders   "FALSE"</span>
<span class="co">#&gt; chronic pulmonary disease      "FALSE"</span>
<span class="co">#&gt; diabetes uncomplicated         "TRUE" </span>
<span class="co">#&gt; diabetes complicated           "TRUE" </span>
<span class="co">#&gt; hypothyroidism                 "FALSE"</span>
<span class="co">#&gt; renal failure                  "FALSE"</span>
<span class="co">#&gt; liver disease                  "FALSE"</span>
<span class="co">#&gt; peptic ulcer disease           "FALSE"</span>
<span class="co">#&gt; AIDS/HIV                       "FALSE"</span>
<span class="co">#&gt; lymphoma                       "FALSE"</span>
<span class="co">#&gt; metastatic cancer              "TRUE" </span>
<span class="co">#&gt; solid tumor                    "TRUE" </span>
<span class="co">#&gt; rheumatoid arthritis           "FALSE"</span>
<span class="co">#&gt; coagulopathy                   "FALSE"</span>
<span class="co">#&gt; obesity                        "FALSE"</span>
<span class="co">#&gt; weight loss                    "FALSE"</span>
<span class="co">#&gt; fluid electrolyte disorders    "FALSE"</span>
<span class="co">#&gt; blood loss anemia              "FALSE"</span>
<span class="co">#&gt; deficiency anemia              "FALSE"</span>
<span class="co">#&gt; alcohol abuse                  "FALSE"</span>
<span class="co">#&gt; drug abuse                     "FALSE"</span>
<span class="co">#&gt; psychoses                      "FALSE"</span>
<span class="co">#&gt; depression                     "FALSE"</span>
<span class="co">#&gt; sum_all                        "2"</span></code></pre></div>
</div>
<div id="conditions" class="section level1">
<h1 class="hasAnchor">
<a href="#conditions" class="anchor"></a>Conditions</h1>
<p>Consider Alice once more. Suppose she got a THA and had some surgical procedure codes recorded at hospital visits either before, during or after her index surgery. Those codes are recorded by the Nomesco classification of surgical procedures (also known as KVA codes in Swedish). Here, “post_op” indicates whether the code was recorded after surgery or not. This information is not always accessible by pure date stamps (if so, the approach illustrated in <code><a href="../articles/coder.html">vignette("coder")</a></code> could be used instead).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">nomesco</span> <span class="op">&lt;-</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    id      <span class="op">=</span> <span class="st">"Alice"</span>,
    kva     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AA01"</span>, <span class="st">"NFC01"</span><span class="op">)</span>,
    post_op <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Thus, the “post_op” column is a Boolean/logical vector with a name recognized from the “condition” column in <code>hip_ae</code>, a classcodes object used to identify adverse events after THA (the use of <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> is further explained below and is used here since <code>hip_ae</code> includes codes for both ICD and NOMESCO/KVA).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/set_classcodes.html">set_classcodes</a></span><span class="op">(</span><span class="va">hip_ae</span>, regex <span class="op">=</span> <span class="st">"kva"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Classcodes object</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Regular expressions:</span>
<span class="co">#&gt;    kva </span>
<span class="co">#&gt; Indices:</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   group kva                                                            condition</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                                                          &lt;chr&gt;    </span>
<span class="co">#&gt; 1 KVA   ^(NF([CF-HJ-MS-TW]|A(02|1[12]|2[0-2])|Q09|U[013489]9)|QD(A10|… post_op</span></code></pre></div>
<p>A code from <code>nomesco$kva</code> will only be recognized as an adverse events if 1) the code is matched by the relevant regular expression, and 2) the extra condition (from <code>nomesco$post_op</code>) is <code>TRUE.</code></p>
<p>We need to specify that codes are based on regular expressions matching NOMESCO codes. We do this by the <code>regex</code> argument passed to <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> by the <code>cc_args</code> argument.</p>
<p>In the data set (<code>nomesco</code>), “AA01” was recorded after surgery but does not indicate a potential adverse event. “NFC01” is a potential adverse event but was recorded already before surgery. Therefore, no adverse event will be recognized in this case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">pat</span>, codedata <span class="op">=</span> <span class="va">nomesco</span>, cc <span class="op">=</span> <span class="va">hip_ae</span>, id <span class="op">=</span> <span class="st">"id"</span>, code <span class="op">=</span> <span class="st">"kva"</span>,
           cc_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>regex <span class="op">=</span> <span class="st">"kva"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; index calculated as number of relevant categories</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;   id    KVA   index</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;lgl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Alice FALSE     0</span></code></pre></div>
</div>
<div id="use-classcodes-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#use-classcodes-objects" class="anchor"></a>Use classcodes objects</h1>
<p>Most functions do not use the classcodes object themselves, but a modified version passed through <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code>. This function can be called directly but is more often invoked by arguments passed by the <code>cc_args</code> argument used in other functions (as in the example above).</p>
<div id="explicit-use-of-set_classcodes" class="section level2">
<h2 class="hasAnchor">
<a href="#explicit-use-of-set_classcodes" class="anchor"></a>Explicit use of <code>set_classcodes()</code>
</h2>
<p>We might use <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> to prepare a classification scheme according to the Charlson comorbidity index based on ICD-8 <span class="citation">(Brusselaers and Lagergren 2017)</span>. Assume that such codes might be found in character strings with leading prefixes or in the middle of a more verbatim description. This is controlled by setting the argument <code>start = FALSE</code>, meaning that the identified ICD-8 codes do not need to appear in the beginning of the character string. We might assume, however, that there is no more information after the code (as specified by <code>stop = TRUE</code>). We can also use some more specific and unique group names as specified by <code>tech_names</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">charlson_icd8</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/set_classcodes.html">set_classcodes</a></span><span class="op">(</span>
    <span class="st">"charlson"</span>,
    regex      <span class="op">=</span> <span class="st">"icd8_brusselaers"</span>, <span class="co"># Version based on ICD-8</span>
    start      <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Codes do not have to occur in the beginning of a vector</span>
    stop       <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Code vector must end with the specified codes</span>
    tech_names <span class="op">=</span> <span class="cn">TRUE</span>   <span class="co"># Use long but unique and descriptive variable names</span>
  <span class="op">)</span></code></pre></div>
<p>The resulting object has only one version of regular expressions (<code>icd8_brusselaers</code> as specified). Each regular expression is suffixed with <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> (due to <code>stop = TRUE</code>). Group names might seem cumbersome but this will help to distinguish column names added by <code><a href="../reference/categorize.html">categorize()</a></code> if this function is run repeatedly with different classcodes (i.e. if we calculate both Charlson and Elixhauser indices for the same patients). The original <code>charlson</code> object had 17 rows, but <code>charlson_icd8</code> has only 13, since not all groups are used in this version.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">charlson_icd8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Classcodes object</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Regular expressions:</span>
<span class="co">#&gt;    icd8_brusselaers </span>
<span class="co">#&gt; Indices:</span>
<span class="co">#&gt;    charlson, deyo_ramano, dhoore, ghali, quan_original, quan_updated   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 13 x 9</span>
<span class="co">#&gt;    group description icd8_brusselaers charlson deyo_ramano dhoore ghali</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 char… Acute myoc… (41[0-2])$              1           1      1     1</span>
<span class="co">#&gt;  2 char… Heart fail… (4270|428)$             1           1      1     4</span>
<span class="co">#&gt;  3 char… Peripheral… (44[0-5])$              1           1      1     2</span>
<span class="co">#&gt;  4 char… Cerebrovas… (43[0-8])$              1           1      1     1</span>
<span class="co">#&gt;  5 char… Senile and… (290[01])$              1           1      1     0</span>
<span class="co">#&gt;  6 char… Chronic ob… (49[0-3]|51[5-8…        1           1      1     0</span>
<span class="co">#&gt;  7 char… Systemic l… (7(1[0-2]|34))$         1           1      1     0</span>
<span class="co">#&gt;  8 char… Paraplegia… (344)$                  2           1      1     0</span>
<span class="co">#&gt;  9 char… Chronic gl… (40[34]|58[0-3]…        2           1      1     3</span>
<span class="co">#&gt; 10 char… Diabetes w… (250)$                  2           1      1     0</span>
<span class="co">#&gt; 11 char… Malignant … (1([4-68][0-9]|…        2           1      1     0</span>
<span class="co">#&gt; 12 char… Hepatic co… (070|4560|51[1-…        3           1      1     0</span>
<span class="co">#&gt; 13 char… Secondary … (19[6-9])$              6           1      1     0</span>
<span class="co">#&gt; # … with 2 more variables: quan_original &lt;dbl&gt;, quan_updated &lt;dbl&gt;</span></code></pre></div>
<p>Note that all index columns remain in the tibble. It is thus possible to combine any categorization with any index, although some combinations might be preferred (such as <code>regex_icd9cm_deyo</code> combined with <code>index_deyo_ramano</code>).</p>
<p>We can now use <code>charlson_icd8</code> for classification:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="fl">410</span>, <span class="va">charlson_icd8</span><span class="op">)</span>
<span class="co">#&gt; Classification based on: icd8_brusselaers</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The printed data is of class: classified, matrix.</span>
<span class="co">#&gt; It has 1 row(s).</span>
<span class="co">#&gt; It is here previewed as a tibble</span>
<span class="co">#&gt; Use `print(x, n = NULL)` to print as is (or use `n` to specify the number of rows to preview)!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 1 x 13</span>
<span class="co">#&gt;   charlson_icd8_b… charlson_icd8_b… charlson_icd8_b… charlson_icd8_b…</span>
<span class="co">#&gt;   &lt;lgl&gt;            &lt;lgl&gt;            &lt;lgl&gt;            &lt;lgl&gt;           </span>
<span class="co">#&gt; 1 TRUE             FALSE            FALSE            FALSE           </span>
<span class="co">#&gt; # … with 9 more variables: charlson_icd8_brusselaers_dementia &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_chronic_pulmonary_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_rheumatic_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_hemiplegia_or_paraplegia &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_renal_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_diabetes_complication &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_malignancy &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_moderate_or_severe_liver_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_metastatic_solid_tumor &lt;lgl&gt;</span></code></pre></div>
<p>The ICD-8 code <code>410</code>is recognized as (only) myocardial infarction.</p>
</div>
<div id="implicit-use-of-set_classcodes" class="section level2">
<h2 class="hasAnchor">
<a href="#implicit-use-of-set_classcodes" class="anchor"></a>Implicit use of <code>set_classcodes()</code>
</h2>
<p>Instead of pre-specifying the <code>charlson_icd8</code>, a similar result is achieved by:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span>
  <span class="fl">410</span>,
  <span class="st">"charlson"</span>,
  cc_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    regex      <span class="op">=</span> <span class="st">"icd8_brusselaers"</span>, 
    start      <span class="op">=</span> <span class="cn">FALSE</span>, 
    stop       <span class="op">=</span> <span class="cn">TRUE</span>,
    tech_names <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; The printed data is of class: classified, matrix.</span>
<span class="co">#&gt; It has 1 row(s).</span>
<span class="co">#&gt; It is here previewed as a tibble</span>
<span class="co">#&gt; Use `print(x, n = NULL)` to print as is (or use `n` to specify the number of rows to preview)!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 1 x 13</span>
<span class="co">#&gt;   charlson_icd8_b… charlson_icd8_b… charlson_icd8_b… charlson_icd8_b…</span>
<span class="co">#&gt;   &lt;lgl&gt;            &lt;lgl&gt;            &lt;lgl&gt;            &lt;lgl&gt;           </span>
<span class="co">#&gt; 1 TRUE             FALSE            FALSE            FALSE           </span>
<span class="co">#&gt; # … with 9 more variables: charlson_icd8_brusselaers_dementia &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_chronic_pulmonary_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_rheumatic_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_hemiplegia_or_paraplegia &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_renal_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_diabetes_complication &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_malignancy &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_moderate_or_severe_liver_disease &lt;lgl&gt;,</span>
<span class="co">#&gt; #   charlson_icd8_brusselaers_metastatic_solid_tumor &lt;lgl&gt;</span></code></pre></div>
</div>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Brusselaers2017" class="csl-entry">
Brusselaers, Nele, and Jesper Lagergren. 2017. <span>“The Charlson Comorbidity Index in Registry-Based Research.”</span> <em>Methods of Information in Medicine</em> 56 (05): 401–6. <a href="https://doi.org/10.3414/ME17-01-0051">https://doi.org/10.3414/ME17-01-0051</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/eribul">Erik Bulow</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
